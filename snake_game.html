<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Snake Battle PRO</title>

<style>
body{
    margin:0;
    overflow:hidden;
    font-family:Arial;
    background:#1b5e20;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    flex-direction:column;
    color:white;
}

canvas{
    border-radius:15px;
    box-shadow:0 0 40px black;
    background:#2e7d32;
}

button{
    padding:10px 20px;
    margin:5px;
    border:none;
    border-radius:8px;
    cursor:pointer;
    font-weight:bold;
}

#startScreen{
    position:absolute;
    background:rgba(0,0,0,0.85);
    width:100%;
    height:100%;
    display:flex;
    justify-content:center;
    align-items:center;
    flex-direction:column;
    z-index:10;
}

#pauseBtn{ background:orange; }
#restartBtn{ background:red; color:white; }
#playBtn{ background:#00c853; font-size:18px; }

#ui{
    margin-top:10px;
    text-align:center;
}

#mobileControls{
    margin-top:15px;
    display:none;
}

#mobileControls button{
    font-size:22px;
    padding:12px 18px;
    margin:5px;
    background:#ffffff20;
    color:white;
}

@media (max-width:768px){
    #mobileControls{
        display:block;
    }
}
</style>
</head>
<body>

<div id="startScreen">
    <h1>üêç Snake Battle PRO ‚öîÔ∏è</h1>
    <button id="playBtn">Play Game</button>
</div>

<canvas id="game"></canvas>

<div id="ui">
Player: <span id="pScore">0</span> |
CPU: <span id="cpuScore">0</span> |
Time: <span id="timer">60</span>
<br>
<button id="pauseBtn">Pause</button>
<button id="restartBtn">Restart</button>
</div>

<div id="mobileControls">
    <button onclick="setDirection('UP')">‚¨Ü</button><br>
    <button onclick="setDirection('LEFT')">‚¨Ö</button>
    <button onclick="setDirection('DOWN')">‚¨á</button>
    <button onclick="setDirection('RIGHT')">‚û°</button>
</div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

let box=20;
let width,height;

function resizeCanvas(){
    width=Math.min(window.innerWidth-20,700);
    height=Math.min(window.innerHeight-220,500);
    canvas.width=width;
    canvas.height=height;
}
resizeCanvas();
window.addEventListener("resize",resizeCanvas);

let playerSnake,cpuSnake,direction;
let food;
let playerScore=0,cpuScore=0;
let timeLeft=60;
let gameInterval,timerInterval;
let paused=false;
let gameStarted=false;

function initGame(){
    playerSnake=[{x:5*box,y:5*box}];
    cpuSnake=[{x:15*box,y:10*box}];
    direction="RIGHT";
    playerScore=0;
    cpuScore=0;
    timeLeft=60;
    paused=false;

    document.getElementById("pScore").innerText=0;
    document.getElementById("cpuScore").innerText=0;
    document.getElementById("timer").innerText=60;

    spawnFood();

    clearInterval(gameInterval);
    clearInterval(timerInterval);

    gameInterval=setInterval(draw,100);
    timerInterval=setInterval(()=>{
        if(!paused){
            timeLeft--;
            document.getElementById("timer").innerText=timeLeft;
            if(timeLeft<=0) endGame();
        }
    },1000);
}

function spawnFood(){
    food={
        x:Math.floor(Math.random()*(width/box))*box,
        y:Math.floor(Math.random()*(height/box))*box
    };
}

function setDirection(dir){
    if(!gameStarted) return;
    if(dir==="LEFT"&&direction!=="RIGHT") direction="LEFT";
    if(dir==="RIGHT"&&direction!=="LEFT") direction="RIGHT";
    if(dir==="UP"&&direction!=="DOWN") direction="UP";
    if(dir==="DOWN"&&direction!=="UP") direction="DOWN";
}

window.addEventListener("keydown",(e)=>{
    if(!gameStarted) return;

    if(e.key==="ArrowLeft") setDirection("LEFT");
    if(e.key==="ArrowRight") setDirection("RIGHT");
    if(e.key==="ArrowUp") setDirection("UP");
    if(e.key==="ArrowDown") setDirection("DOWN");
    if(e.key===" ") togglePause();
});

let touchStartX=0,touchStartY=0;
canvas.addEventListener("touchstart",(e)=>{
    touchStartX=e.touches[0].clientX;
    touchStartY=e.touches[0].clientY;
});
canvas.addEventListener("touchend",(e)=>{
    let dx=e.changedTouches[0].clientX-touchStartX;
    let dy=e.changedTouches[0].clientY-touchStartY;

    if(Math.abs(dx)>Math.abs(dy)){
        if(dx>0) setDirection("RIGHT");
        else setDirection("LEFT");
    }else{
        if(dy>0) setDirection("DOWN");
        else setDirection("UP");
    }
});

function togglePause(){
    paused=!paused;
    document.getElementById("pauseBtn").innerText=paused?"Play":"Pause";
}

document.getElementById("pauseBtn").onclick=togglePause;
document.getElementById("restartBtn").onclick=initGame;
document.getElementById("playBtn").onclick=()=>{
    document.getElementById("startScreen").style.display="none";
    gameStarted=true;
    initGame();
};

function moveSnake(snake,dir){
    let x=snake[0].x;
    let y=snake[0].y;
    if(dir==="LEFT") x-=box;
    if(dir==="RIGHT") x+=box;
    if(dir==="UP") y-=box;
    if(dir==="DOWN") y+=box;
    return {x,y};
}

function cpuAI(){
    let head=cpuSnake[0];
    if(food.x>head.x) return "RIGHT";
    if(food.x<head.x) return "LEFT";
    if(food.y>head.y) return "DOWN";
    return "UP";
}

function draw(){
    if(paused) return;

    ctx.fillStyle="#2e7d32";
    ctx.fillRect(0,0,width,height);

    let newHead=moveSnake(playerSnake,direction);

    if(newHead.x<0||newHead.y<0||newHead.x>=width||newHead.y>=height){
        endGame();
        return;
    }

    if(newHead.x===food.x&&newHead.y===food.y){
        playerScore++;
        document.getElementById("pScore").innerText=playerScore;
        spawnFood();
    } else playerSnake.pop();

    playerSnake.unshift(newHead);

    let cpuDir=cpuAI();
    let cpuHead=moveSnake(cpuSnake,cpuDir);

    if(cpuHead.x===food.x&&cpuHead.y===food.y){
        cpuScore++;
        document.getElementById("cpuScore").innerText=cpuScore;
        spawnFood();
    } else cpuSnake.pop();

    cpuSnake.unshift(cpuHead);

    drawSnake(playerSnake,"#1b5e20");
    drawSnake(cpuSnake,"#0d47a1");

    ctx.fillStyle="red";
    ctx.beginPath();
    ctx.arc(food.x+box/2,food.y+box/2,box/2,0,Math.PI*2);
    ctx.fill();
}

function drawSnake(snake,color){
    snake.forEach((s,i)=>{
        ctx.fillStyle=color;
        ctx.fillRect(s.x,s.y,box,box);
    });
}

function endGame(){
    clearInterval(gameInterval);
    clearInterval(timerInterval);

    let result="Draw!";
    if(playerScore>cpuScore) result="üèÜ You Win!";
    if(cpuScore>playerScore) result="üíÄ CPU Wins!";
    alert(result);
}
</script>

</body>
</html>
